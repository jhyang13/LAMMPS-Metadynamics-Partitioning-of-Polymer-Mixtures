# single polymer chain into pore with metaD
# Input script parameters adapted from "lammps.sandia.gov/bench.html#chain"

clear
units		lj
processors      * * *
dimension	3
boundary 	p p p 
atom_style 	bond  

region		box block -15 15 -15 15 0 30 units box
create_box      2 box bond/types 1 extra/bond/per/atom 1

read_data	poly.data add append 
mass		* 1.0

group		poly type 1 2 
group           long type 1
group           short type 2
group           onel id 1:50
group           ones id 51:60

neighbor 	4.0  bin
neigh_modify	every 1 delay 1
comm_modify  	cutoff 1.9

pair_style 	soft 1.122462
pair_coeff      * * 4

bond_style		fene
bond_coeff		1 30.0 1.5 1.0 1.0
special_bonds           fene

variable 	prefactor equal ramp(4,100)

fix 		1 all nve
fix 		2 all langevin 1.0 1.0 10.0 {RAND1}
fix		3 all adapt 1 pair soft a * * v_prefactor
fix             4 all wall/lj93 zhi EDGE 1.0 1.0 0.858374 units box pbc yes
fix             5 all wall/lj93 zlo 0.0 1.0 1.0 0.858374 units box pbc yes

thermo				1000
thermo_style 			custom step temp press ke pe epair ebond etotal fmax fnorm
thermo_modify			flush yes

timestep	0.01
run 		1000000

compute         1 onel gyration
compute         2 ones gyration
compute         3 onel msd com yes
compute         4 ones msd com yes

fix     at1 all ave/time 10 10 100 c_1 c_2 file rg_soft.txt
fix     at2 all ave/time 10 10 100 c_3[1] c_3[2] c_3[3] c_3[4] c_4[1] c_4[2] c_4[3] c_4[4] file msd_soft.txt

dump                    1 poly custom 1000 poly_soft.lammpstrj.gz id type x y z ix iy iz fx fy fz
dump_modify             1 sort id pbc yes

run 		1000000

unfix           2
unfix 		3

pair_style 	lj/cut 2.5
pair_coeff 	* * 1.0 1.0 1.122462
pair_modify	shift yes

fix		6 all langevin 1.0 1.0 10.0 {RAND2}

thermo				1000
thermo_style 			custom step temp press ke pe epair ebond etotal fmax fnorm
thermo_modify			flush yes

run		1000000

fix     at1 all ave/time 10 10 100 c_1 c_2 file rg_lj.txt
fix     at2 all ave/time 10 10 100 c_3[1] c_3[2] c_3[3] c_3[4] c_4[1] c_4[2] c_4[3] c_4[4] file msd_lj.txt

dump                    2 poly custom 1000 poly_lj.lammpstrj.gz id type x y z ix iy iz fx fy fz
dump_modify             2 sort id pbc yes

run		1000000
